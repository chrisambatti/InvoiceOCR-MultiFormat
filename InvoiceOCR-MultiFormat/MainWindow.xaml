<Window x:Class="InvoiceOCR_MultiFormat.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Universal Invoice OCR" Height="800" Width="1300"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Upload Button and Progress -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <Button Name="UploadButton" Content="Upload Invoice (PDF/Image)" 
                    Width="200" Height="40" FontSize="14" 
                    Click="Upload_Click"
                    Background="#4CAF50" Foreground="White"
                    Cursor="Hand"/>

            <TextBlock Name="StatusText" 
                       Text="" 
                       FontSize="12" 
                       FontWeight="Bold"
                       Foreground="#FF6600"
                       HorizontalAlignment="Center"
                       Margin="0,10,0,0"/>
        </StackPanel>

        <!-- Header Information -->
        <Grid Grid.Row="1" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Column -->
            <StackPanel Grid.Column="0" Margin="0,0,15,0">
                <Border BorderBrush="#2196F3" BorderThickness="2" Padding="10" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="📄 Invoice Details" FontWeight="Bold" FontSize="14" Foreground="#2196F3" Margin="0,0,0,10"/>

                        <TextBlock Text="Company Name:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="CompanyNameBox" FontSize="12" Margin="0,0,0,8" TextWrapping="Wrap"/>

                        <TextBlock Text="Invoice No:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="InvoiceNoBox" FontSize="12" Margin="0,0,0,8"/>

                        <TextBlock Text="Date:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="DateBox" FontSize="12" Margin="0,0,0,8"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Middle Column -->
            <StackPanel Grid.Column="1" Margin="0,0,15,0">
                <Border BorderBrush="#FF9800" BorderThickness="2" Padding="10" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="💼 Business Info" FontWeight="Bold" FontSize="14" Foreground="#FF9800" Margin="0,0,0,10"/>

                        <TextBlock Text="TRN / Tax ID:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="TRNBox" FontSize="12" Margin="0,0,0,8"/>

                        <TextBlock Text="Sales Person:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="SalesPersonBox" FontSize="12" Margin="0,0,0,8"/>

                        <TextBlock Text="Payment Terms:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="PaymentTermsBox" FontSize="12" Margin="0,0,0,8"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Right Column -->
            <StackPanel Grid.Column="2">
                <Border BorderBrush="#9C27B0" BorderThickness="2" Padding="10" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="🚚 Shipping &amp; Orders" FontWeight="Bold" FontSize="14" Foreground="#9C27B0" Margin="0,0,0,10"/>

                        <TextBlock Text="Ship Date:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="ShipDateBox" FontSize="12" Margin="0,0,0,8"/>

                        <TextBlock Text="D.O. Number:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="DONumberBox" FontSize="12" Margin="0,0,0,8"/>

                        <TextBlock Text="S.O. Number:" FontWeight="Bold" FontSize="11" Margin="0,5,0,2"/>
                        <TextBlock Name="SONumberBox" FontSize="12" Margin="0,0,0,8"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Grid>

        <!-- Invoice Items Table -->
        <Border Grid.Row="2" BorderBrush="#607D8B" BorderThickness="2" CornerRadius="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="#607D8B" Padding="10">
                    <TextBlock Text="📋 Invoice Line Items" FontWeight="Bold" FontSize="16" Foreground="White"/>
                </Border>

                <ScrollViewer Grid.Row="1" Margin="5">
                    <DataGrid Name="InvoiceItemsGrid" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              HeadersVisibility="Column"
                              GridLinesVisibility="All"
                              AlternatingRowBackground="#F5F5F5"
                              RowBackground="White"
                              CanUserResizeColumns="True"
                              CanUserSortColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Sr No." Binding="{Binding SrNo}" Width="60"/>
                            <DataGridTextColumn Header="Item Code" Binding="{Binding ItemCode}" Width="120"/>
                            <DataGridTextColumn Header="Item Description" Binding="{Binding ItemDescription}" Width="300"/>
                            <DataGridTextColumn Header="UOM" Binding="{Binding UOM}" Width="70"/>
                            <DataGridTextColumn Header="QTY" Binding="{Binding Quantity}" Width="80"/>
                            <DataGridTextColumn Header="Unit Rate" Binding="{Binding UnitRate}" Width="100"/>
                            <DataGridTextColumn Header="Total (Excl. VAT)" Binding="{Binding TotalExclVAT}" Width="130"/>
                            <DataGridTextColumn Header="VAT %" Binding="{Binding VATPercent}" Width="70"/>
                            <DataGridTextColumn Header="VAT Amount" Binding="{Binding VATAmount}" Width="110"/>
                            <DataGridTextColumn Header="Total (Incl. VAT)" Binding="{Binding TotalInclVAT}" Width="130"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Window>